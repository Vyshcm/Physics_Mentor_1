{% extends "base.html" %}
{% load static %}

{% block content %}
<style>
    :root {
        --dark-blue: #0f1c3f;
        --gradient-bg: linear-gradient(135deg, #0f1c3f 0%, #1e4d58 100%);
        --turquoise: #33c1a8;
        --white: #ffffff;
        --light-bg: #f8f9fc;
        --text-muted: #8c98a4;
        --error-red: #ef4444;
        --warning-orange: #f59e0b;
        --success-green: #10b981;
    }

    .dashboard-header {
        background: var(--gradient-bg);
        color: var(--white);
        padding: 60px 5%;
    }

    .dashboard-header h1 {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 10px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }

    .stat-card {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 20px;
        border-radius: 12px;
        backdrop-filter: blur(5px);
    }

    .stat-card h4 {
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        opacity: 0.8;
        margin: 0 0 10px 0;
    }

    .stat-card .value {
        font-size: 1.8rem;
        font-weight: 700;
    }

    .dashboard-body {
        padding: 40px 5%;
    }

    .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dark-blue);
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .action-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
    }

    .action-card {
        background: var(--white);
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        transition: transform 0.3s, box-shadow 0.3s;
        text-decoration: none;
        color: inherit;
        display: flex;
        flex-direction: column;
        border: 1px solid #eef2f6;
    }

    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .icon-box {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
    }

    .icon-box svg {
        width: 24px;
        height: 24px;
        color: white;
    }

    .bg-blue {
        background: linear-gradient(135deg, #60a5fa, #3b82f6);
    }

    .bg-green {
        background: linear-gradient(135deg, #34d399, #10b981);
    }

    .bg-purple {
        background: linear-gradient(135deg, #a78bfa, #8b5cf6);
    }

    .bg-orange {
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
    }

    .bg-red {
        background: linear-gradient(135deg, #f87171, #ef4444);
    }

    .bg-teal {
        background: linear-gradient(135deg, #2dd4bf, #0f766e);
    }

    .bg-indigo {
        background: linear-gradient(135deg, #818cf8, #4f46e5);
    }

    .action-card h3 {
        font-size: 1.25rem;
        margin: 0 0 8px 0;
        color: var(--dark-blue);
    }

    .action-card p {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin: 0;
        line-height: 1.4;
    }

    .badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 700;
        margin-top: 15px;
        align-self: flex-start;
    }

    .badge-urgent {
        background: #fee2e2;
        color: #ef4444;
    }

    .badge-info {
        background: #e0f2fe;
        color: #0ea5e9;
    }
</style>

<div class="dashboard-header">
    <h1>Teacher Dashboard</h1>
    <p>Welcome back, {{ request.user.first_name|default:"Admin" }}!</p>

    <div class="stats-grid">
        <div class="stat-card">
            <h4>Total Students</h4>
            <div class="value">{{ total_students }}</div>
        </div>
        <div class="stat-card">
            <h4>Active Subscriptions</h4>
            <div class="value">{{ active_subscriptions }}</div>
        </div>
        <div class="stat-card">
            <h4>Expiring Soon (7d)</h4>
            <div class="value" style="color: #fca5a5;">{{ expiring_soon }}</div>
        </div>
        <div class="stat-card">
            <h4>Outstanding/Unpaid</h4>
            <div class="value" style="color: #fca5a5;">{{ unpaid_students }}</div>
        </div>
    </div>
</div>

<div class="dashboard-body">
    <h2 class="section-title">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
        </svg>
        Management Hub
    </h2>

    <div class="action-grid">
        <!-- Students -->
        <a href="{% url 'teacher_students' %}" class="action-card">
            <div class="icon-box bg-blue">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
            </div>
            <h3>Student Management</h3>
            <p>Add students, create parent accounts, and link them to students.</p>
        </a>

        <!-- Attendance -->
        <a href="{% url 'teacher_attendance' %}" class="action-card">
            <div class="icon-box bg-green">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <polyline points="16 11 18 13 22 9" />
                </svg>
            </div>
            <h3>Attendance Control</h3>
            <p>Mark daily attendance and view student participation records.</p>
        </a>

        <!-- Assignments -->
        <a href="{% url 'teacher_assignments' %}" class="action-card">
            <div class="icon-box bg-purple">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14 2 14 8 20 8" />
                    <line x1="16" y1="13" x2="8" y2="13" />
                    <line x1="16" y1="17" x2="8" y2="17" />
                    <polyline points="10 9 9 9 8 9" />
                </svg>
            </div>
            <h3>Assignments</h3>
            <p>Create and assign tasks. Review student submissions and status.</p>
        </a>

        <!-- Quizzes -->
        <a href="{% url 'teacher_quizzes' %}" class="action-card">
            <div class="icon-box bg-orange">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                    <line x1="12" y1="17" x2="12.01" y2="17" />
                </svg>
            </div>
            <h3>Quizzes & Exams</h3>
            <p>Build custom quizzes, publish results, and track exam performance.</p>
        </a>

        <!-- Payments -->
        <a href="{% url 'teacher_payments' %}" class="action-card">
            <div class="icon-box bg-teal">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
                    <line x1="1" y1="10" x2="23" y2="10" />
                </svg>
            </div>
            <h3>Payments & Subs</h3>
            <p>Record fees and manage student subscription periods manually.</p>
        </a>

        <!-- Doubts Inbox -->
        <a href="{% url 'teacher_doubts' %}" class="action-card">
            <div class="icon-box bg-indigo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
            </div>
            <h3>Doubts Inbox</h3>
            <p>Review and reply to doubts submitted by students across all classes.</p>
            {% if pending_doubts > 0 %}
            <span class="badge badge-urgent">{{ pending_doubts }} Pending</span>
            {% endif %}
        </a>

        <!-- Parent Messages -->
        <a href="{% url 'teacher_parent_messages' %}" class="action-card">
            <div class="icon-box bg-red">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                    <polyline points="22,6 12,13 2,6" />
                </svg>
            </div>
            <h3>Parent Messages</h3>
            <p>Direct communication thread with parents regarding student progress.</p>
            {% if pending_messages > 0 %}
            <span class="badge badge-urgent">{{ pending_messages }} New</span>
            {% endif %}
        </a>

        <!-- Notes Management -->
        <a href="{% url 'teacher_notes' %}" class="action-card">
            <div class="icon-box bg-blue">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                </svg>
            </div>
            <h3>Notes</h3>
            <p>Upload and manage study materials for students.</p>
        </a>

        <!-- Live Classes -->
        <a href="{% url 'teacher_live_classes' %}" class="action-card">
            <div class="icon-box bg-purple">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
                    <line x1="8" y1="21" x2="16" y2="21" />
                    <line x1="12" y1="17" x2="12" y2="21" />
                </svg>
            </div>
            <h3>Live Classes</h3>
            <p>Schedule and manage online live sessions.</p>
        </a>
    </div>
</div>
{% endblock %}